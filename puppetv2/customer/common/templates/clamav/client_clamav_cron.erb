#!/bin/bash
/usr/bin/freshclam --no-warning --stdout | /usr/bin/logger -t clamav -p local6.info
echo "CLAMSCAN START: $(date +%Y%m%d%H%M%S)" | /usr/bin/logger -t clamav -p local6.info
/usr/bin/clamscan -roi / \
<% if @clamav_move_dir -%>
--move=<%= @clamav_move_dir %> \
--exclude-dir='<%= @clamav_move_dir -%>' \
<% end -%>
--exclude-dir='^/sys' \
--exclude-dir='^/proc' \
--exclude-dir='^/dev' \
<% if @exclude_dir -%>
<% @exclude_dir.each do |exclude| -%>
--exclude-dir='<%= exclude %>' \
<% end -%>
<% end -%>
<% if @exclude_files -%>
<% @exclude_files.each do |excludefile| -%>
--exclude='<%= excludefile %>' \
<% end -%>
<% end -%>
<% if @other_options -%>
<% @other_options.each do |otheroptions| -%>
<%= otheroptions %> \
<% end -%>
<% end -%>
--stdout | /usr/bin/logger -t clamav -p local6.info
echo "CLAMSCAN STOP: $(date +%Y%m%d%H%M%S)" | /usr/bin/logger -t clamav -p local6.info
